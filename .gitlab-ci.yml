image: python:3.8-buster


stages:
  - swag
  - pages

swag:
  image: golang:latest
  stage: swag
  script:
  - go install -v github.com/swaggo/swag/cmd/swag@v1.16.3
  - cd src/ACMESkyNCC/middleware
  - swag init --parseDependency --instanceName ncc
  - cd ../../src/ACMESkyService
  - swag init --parseDependency --instanceName acme
  - cd ../BankService/server
  - swag init --parseDependency --instanceName bank
  - cd ../../FlightCompanyService
  - swag init --parseDependency --instanceName fc
  - cd ../GeoDistance
  - swag init --parseDependency --instanceName geo

pages:
  stage: pages
  before_script:
    - pip install -r requirements.txt
  script:
  - mkdocs build --strict --verbose
  - mv site public
  artifacts:
    paths:
    - public
  only:
    - main
